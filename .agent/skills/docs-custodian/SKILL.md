---
name: docs-custodian
description: Автоматизирует синхронизацию документации (README, CHANGELOG) с кодом. Использовать, когда меняется публичное поведение API/CLI или требуется бамп версии и обновление чейнджлога.
---

# Хранитель документации (Docs Custodian)

Этот навык обеспечивает актуальность документации, соблюдение SemVer и правил Keep a Changelog.

## Когда использовать этот навык
- При изменении публичного поведения (API, CLI, конфиги, форматы, дефолты или коды ошибок).
- При необходимости выпустить релиз (бамп версии).
- Для поддержания порядка в `README.md` и `CHANGELOG.md`.

## Рабочий процесс (Workflow)

При внесении изменений, затрагивающих публичный контракт:

1.  **Анализ изменений**: Определить тип изменений согласно SemVer (MAJOR, MINOR, PATCH).
2.  **Обновление документации**:
    - [ ] Обновить примеры, параметры и конфиги в `README.md`.
    - [ ] Добавить запись в `CHANGELOG.md` в соответствующую категорию (`Added`, `Changed`, `Fixed`, `Deprecated`, `Removed`).
    - [ ] Пометить критические изменения меткой `BREAKING`.
3.  **Бамп версии**: Обновить версию в `pyproject.toml`, `package.json` или `VERSION`.
4.  **Валидация**: Проверить ссылки и форматирование (markdownlint).

## Правила версионирования (SemVer)

- **MAJOR**: Несовместимые изменения API.
- **MINOR**: Добавление функциональности, совместимой с предыдущими версиями.
- **PATCH**: Исправление ошибок, совместимое с предыдущими версиями.

## Правила CHANGELOG.md (Keep a Changelog)

Используйте следующие заголовки:
- `### Added` — для новых функций.
- `### Changed` — для изменений в существующей функциональности.
- `### Deprecated` — для функциональности, которая будет удалена в будущих версиях.
- `### Removed` — для удаленной функциональности.
- `### Fixed` — для исправлений.
- `### Security` — в случае уязвимостей.

> [!IMPORTANT]
> Для внутренних изменений (рефактор, оптимизация), не затрагивающих публичный контракт, запись в `CHANGELOG.md` не обязательна.

## Инструкции

### Обновление версии в pyproject.toml
```bash
# Если используется poetry
poetry version patch | minor | major

# Если вручную
sed -i '' 's/version = "[^"]*"/version = "X.Y.Z"/' pyproject.toml
```

### Формат записи в CHANGELOG.md
```markdown
## [X.Y.Z] - YYYY-MM-DD
### Added
- [ ] Новая функция извлечения вложений.
### Fixed
- [ ] Исправлена ошибка кодировки при чтении JSON.
```

## Ресурсы (Resources)
- `examples/CHANGELOG-template.md` — эталонный формат чейнджлога.
- `examples/pyproject-template.toml` — пример структуры с версионированием.
