# Outlook Syncer

Скрипт для извлечения последних сообщений (Входящие и Отправленные) из Microsoft Outlook (Desktop) для последующего анализа ИИ-агентом.

## Назначение
Скрипт служит мостом между локальным клиентом Outlook и ИИ. Он извлекает текст писем, темы, отправителей и даты, сохраняя их в формате JSON. Это позволяет агенту анализировать переписку, не имея прямого доступа к API Microsoft (который часто ограничен корпоративными политиками).

## Как это работает

### Mac OS (AppleScript)
- Использует AppleScript для взаимодействия с приложением "Microsoft Outlook".
- Извлекает сообщения из всех Exchange-аккаунтов.
- Специально нацелен на папки: `Входящие`, `Отправленные`, `Банат ПХГ`, `Inbox`, `Sent Items`.
- **Важно**: В Outlook для Mac `message 1` — это самое новое сообщение.
- Скрипт записывает данные во временный файл в кодировке UTF-8, чтобы избежать проблем с переполнением буфера AppleScript и спецсимволами.

### Windows (pywin32)
- Использует библиотеку `win32com.client` для доступа к MAPI.
- Сортирует сообщения по времени получения (новые первые).
- Извлекает тело письма (Body), тему и отправителя.

## Запуск

### Требования
- Установленный Microsoft Outlook (Desktop версия).
- Mac OS: Разрешение на "Автоматизацию" для терминала/IDE.
- Windows: `pip install pywin32`.

### Команда
```bash
python3 outlook-analyzer/outlook_syncer.py
```

## Выходные данные
После запуска создается файл `outlook-analyzer/daily_emails.json`. 
Формат:
```json
[
  {
    "folder": "Название папки",
    "subject": "Тема письма",
    "sender": "Имя отправителя",
    "received": "Дата получения",
    "content": "Текст письма (первые 500-1000 символов)"
  }
]
```

## Планы по развитию
- [ ] Фильтрация по дате на стороне AppleScript для ускорения работы.
- [ ] Извлечение вложений (имен файлов).
- [ ] Определение цепочек писем (ThreadID).
